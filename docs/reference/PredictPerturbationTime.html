<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict Perturbation Pseudotime (Absorbing Markov Chain Hitting Time) — PredictPerturbationTime • compact</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict Perturbation Pseudotime (Absorbing Markov Chain Hitting Time) — PredictPerturbationTime"><meta name="description" content='Calculates the expected hitting time for cells to reach a defined "sink" or target state
under a simulated perturbation. Mathematically, this function models the perturbation
transition probability matrix as an Absorbing Markov Chain. It calculates the expected
number of random walk steps required for any transient cell to reach the absorbing
sink states, effectively quantifying the transcriptomic "distance" or resistance to
the perturbation-driven trajectory.'><meta property="og:description" content='Calculates the expected hitting time for cells to reach a defined "sink" or target state
under a simulated perturbation. Mathematically, this function models the perturbation
transition probability matrix as an Absorbing Markov Chain. It calculates the expected
number of random walk steps required for any transient cell to reach the absorbing
sink states, effectively quantifying the transcriptomic "distance" or resistance to
the perturbation-driven trajectory.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">compact</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic_tutorial.html">co-expression module perturbation analysis</a></li>
    <li><a class="dropdown-item" href="../articles/TF_tutorial.html">transcription factor perturbation analysis</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predict Perturbation Pseudotime (Absorbing Markov Chain Hitting Time)</h1>

      <div class="d-none name"><code>PredictPerturbationTime.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the expected hitting time for cells to reach a defined "sink" or target state
under a simulated perturbation. Mathematically, this function models the perturbation
transition probability matrix as an Absorbing Markov Chain. It calculates the expected
number of random walk steps required for any transient cell to reach the absorbing
sink states, effectively quantifying the transcriptomic "distance" or resistance to
the perturbation-driven trajectory.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PredictPerturbationTime</span><span class="op">(</span></span>
<span>  <span class="va">seurat_obj</span>,</span>
<span>  <span class="va">perturbation_name</span>,</span>
<span>  <span class="va">graph</span>,</span>
<span>  sink_cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_name <span class="op">=</span> <span class="st">"perturbation_pseudotime"</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  return_seurat <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-seurat-obj">seurat_obj<a class="anchor" aria-label="anchor" href="#arg-seurat-obj"></a></dt>
<dd><p>A Seurat object containing the required graphs.</p></dd>


<dt id="arg-perturbation-name">perturbation_name<a class="anchor" aria-label="anchor" href="#arg-perturbation-name"></a></dt>
<dd><p>Character. The base name of the simulated perturbation.
The function expects to find a transition probability graph named
<code>paste0(perturbation_name, '_tp')</code> in <code>seurat_obj@graphs</code>.</p></dd>


<dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>Character. The name of the K-Nearest Neighbors (KNN) graph stored in
<code>seurat_obj@graphs</code> (e.g., "RNA_nn"). This is used to mask the transition
probabilities and force the random walk to strictly obey the biological manifold.</p></dd>


<dt id="arg-sink-cells">sink_cells<a class="anchor" aria-label="anchor" href="#arg-sink-cells"></a></dt>
<dd><p>Character vector. An explicit list of cell barcodes to be defined
as the target/absorbing states. If <code>NULL</code>, <code>group.by</code> and <code>group_name</code>
must be provided.</p></dd>


<dt id="arg-group-by">group.by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>Character. The name of a column in <code>seurat_obj@meta.data</code> containing
cluster or group identities. Used to automatically define sink cells.</p></dd>


<dt id="arg-group-name">group_name<a class="anchor" aria-label="anchor" href="#arg-group-name"></a></dt>
<dd><p>Character vector. The specific identity class(es) within the
<code>group.by</code> column to define as the sink/target states.</p></dd>


<dt id="arg-output-name">output_name<a class="anchor" aria-label="anchor" href="#arg-output-name"></a></dt>
<dd><p>Character. The column name used to store the resulting pseudotime
values in <code>seurat_obj@meta.data</code>. Default is <code>"perturbation_pseudotime"</code>.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Numeric. The maximum number of iterations for the fixed-point
iterative sparse solver. Default is <code>10000</code>.</p></dd>


<dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>Numeric. The convergence tolerance for the iterative solver.
Default is <code>1e-4</code>.</p></dd>


<dt id="arg-return-seurat">return_seurat<a class="anchor" aria-label="anchor" href="#arg-return-seurat"></a></dt>
<dd><p>Logical. Whether to return a Seurat object (default), or to return
the calculated perturbation pseudotime as a numeric vector.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A Seurat object with the calculated perturbation times appended to the
metadata under the column name specified by <code>output_name</code>. Sink cells
are strictly assigned a time of 0.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses a highly efficient, matrix-free iterative solver to calculate
hitting times, ensuring it scales comfortably to hundreds of thousands of cells
without dense matrix inversion. Cells that hit the <code>max_iter</code> ceiling are likely
on disconnected manifold "islands" or face severe topological bottlenecks preventing
them from reaching the specified sink states under the current perturbation.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smorabit.github.io" class="external-link">Sam Morabito</a>, <a href="https://github.com/rootze" class="external-link">Zechuan Shi</a>, <a href="https://swaruplab.bio.uci.edu/" class="external-link">Swarup Lab</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

