% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AlertHeatmap.R
\name{AlertHeatmap}
\alias{AlertHeatmap}
\title{AlertHeatmap: visualize pathway-level perturbation metrics as a heatmap}
\usage{
AlertHeatmap(
  seurat_obj,
  misc_name = "AlertSystem",
  top_n = 5,
  side = c("both", "positive", "negative"),
  scale_mode = c("none", "unit", "zscale"),
  unit_mode = c("max", "robust"),
  select_by = c("concordance", "effect", "abs_effect"),
  reorder_by = c("effect", "select"),
  unit_q = 0.9,
  reorder = TRUE,
  fill_limits = NULL,
  show_concordance = TRUE,
  show_robustness = FALSE
)
}
\arguments{
\item{seurat_obj}{A Seurat object that has been processed with
\code{AlertSystemScore()} and contains a metrics table in
\code{seurat_obj@misc$AlertSystem$metrics}. This can be either from
a fresh run of \code{AlertSystemScore()} or after re-attaching a
previously saved AlertSystem state (e.g. via \code{LoadAlertSystem()}
or \code{readRDS("..._AlertSystem_info.rds")}).}

\item{misc_name}{Name of the misc slot where AlertSystem results are stored.
Default is \code{"AlertSystem"}.}

\item{top_n}{Integer; number of top pathways to select per side (positive
and/or negative). For example, \code{top_n = 5} and \code{side = "both"}
can yield up to 10 pathways (5 most positive, 5 most negative).}

\item{side}{Character string indicating which side(s) of the effect
distribution to use. One of \code{"both"}, \code{"positive"}, or
\code{"negative"}. Default is \code{"both"}.}

\item{scale_mode}{Character; one of:
\describe{
\item{"none"}{Use raw effect values (default).}
\item{"unit"}{Scale effect into approximately \code{c(-1, 1)} by dividing by a
global magnitude (see \code{unit_mode}, \code{unit_q}).}
\item{"zscale"}{Z-score effect values within each pathway across groups:
\eqn{z = (x - \mu)/\sigma}. If there is only one group, this mode
automatically falls back to \code{"none"}.}
}}

\item{unit_mode}{Character; only used when \code{scale_mode = "unit"}.
One of:
\describe{
\item{"max"}{Divide by the maximum absolute effect across all selected
pathway/group combinations. This makes the most extreme value exactly
Â±1.}
\item{"robust"}{Divide by a high quantile (see \code{unit_q}) of the
absolute effect distribution, which reduces the influence of extreme
outliers and improves contrast among moderately changed pathways.}
}}

\item{select_by}{Character; metric used to rank pathways for inclusion
within each side of the mean \code{effect} distribution. One of
\code{"concordance"} (default), \code{"effect"}, or \code{"abs_effect"}.}

\item{reorder_by}{Character; if \code{reorder = TRUE}, controls how pathways
are ordered on the y-axis. One of \code{"effect"} (default; negative to
positive mean effect) or \code{"select"} (order by the selection rank).}

\item{unit_q}{Numeric between 0 and 1; quantile of \code{|effect|} used as
the scaling factor when \code{unit_mode = "robust"}. Default is 0.9.}

\item{reorder}{Logical; if \code{TRUE} (default), reorder pathways on the
y-axis by their mean effect (from most negative to most positive).}

\item{fill_limits}{Optional numeric vector of length 2 giving limits for
the fill scale. If \code{NULL}, limits are set automatically depending
on \code{scale_mode}.}

\item{show_concordance}{Logical; if TRUE (default), show the concordance
metric as text labels when available.}

\item{show_robustness}{Logical; if TRUE, show the robustness metric
(column \code{robust_gt_thresh}) as text labels when available. Default
is FALSE, so robustness is not shown even if computed, unless
explicitly requested.}
}
\value{
A ggplot2 heatmap object.
}
\description{
This function visualizes the AlertSystem metrics stored in
\code{seurat_obj@misc$AlertSystem$metrics} as a pathways-by-group heatmap.
It selects the top N most positively and/or negatively changed pathways
based on the mean \code{effect} (summarized logFC) across groups, and can
optionally rescale values for visualization.
}
\details{
Tiles are filled by the \code{effect} column, while additional metrics
such as \code{concordance} and the robustness score
(\code{robust_gt_thresh}, fraction of strong, sign-consistent cells among
all cells in a group) are displayed as text overlays (labels) if present
and non-missing. In the plot, this robustness is shown simply as
\code{"robustness"}.
}
