% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AlertSystemScore.R
\name{.add_logfc_scores}
\alias{.add_logfc_scores}
\title{Add log2 fold-change columns between two sets of UCell scores}
\usage{
.add_logfc_scores(
  seurat_obj,
  pre_suffix,
  post_suffix,
  logfc_suffix,
  eps = 1e-10
)
}
\arguments{
\item{seurat_obj}{A Seurat object with UCell scores stored in
\code{seurat_obj@meta.data}.}

\item{pre_suffix}{Character suffix used to identify baseline columns
(e.g. \code{"_M6_RNA"}).}

\item{post_suffix}{Character suffix used to identify perturbation columns
(e.g. \code{"_M6_M6up"}).}

\item{logfc_suffix}{Character suffix used for the new logFC columns
(e.g. \code{"_M6_logFC"}).}

\item{eps}{Small numeric constant added to both pre and post scores to
avoid division by zero in the log-ratio.}
}
\value{
The input Seurat object with additional logFC columns added to
\code{seurat_obj@meta.data}.
}
\description{
This internal helper computes log2 fold-change between a set of "pre"
UCell scores and matching "post" scores stored in the Seurat object's
metadata. It searches for columns ending in \code{pre_suffix} and
expects matching columns where \code{pre_suffix} is replaced by
\code{post_suffix}. For each pathway, it adds a new column with suffix
\code{logfc_suffix}:
}
\details{
\deqn{logFC = \log_2 \left( \frac{\mathrm{post} + \varepsilon}{\mathrm{pre} + \varepsilon} \right)}
}
\keyword{internal}
